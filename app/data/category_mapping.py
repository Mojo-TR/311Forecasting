from collections import defaultdict

category_mapping = {
    # Water Service & Leaks
    "Water Leak": "Water Service & Leaks",
    "Major Water Leak": "Water Service & Leaks",
    "Minor Water Leak": "Water Service & Leaks",
    "Water Main Valve": "Water Service & Leaks",
    "Water Service": "Water Service & Leaks",
    "Water Meter": "Water Service & Leaks",
    "Meter Investigation": "Water Service & Leaks",
    "Private Leak Violation": "Water Service & Leaks",
    "Water Quality": "Water Service & Leaks",
    "Drinking Water Public Notice": "Water Service & Leaks",
    "Water Shortage Violation": "Water Service & Leaks",
    "Water Adjustment Board Review": "Water Service & Leaks",
    "Restoration due to Meter Work": "Water Service & Leaks",
    'Clinton Water Leak': "Water Service & Leaks",
    'Restoration Due to Utility Work': "Water Service & Leaks",
    'Set Usage Water Billing': "Water Service & Leaks",
    'Water/Sewer/Drainage Billing': "Water Service & Leaks",
    'Fountain Repair': "Water Service & Leaks",
    'Fountain Repair Urgent': "Water Service & Leaks",
    'Water Playground Repair': "Water Service & Leaks",
    'Pool Water Quality Control': "Water Service & Leaks",

    # Sewer & Wastewater
    "Sewer Wastewater": "Sewer & Wastewater",
    "Sewer Wastewater Repair": "Sewer & Wastewater",
    "Sewer Manhole": "Sewer & Wastewater",

    # Drainage & Flooding
    "Drainage": "Drainage & Flooding",
    "Poor Drainage": "Drainage & Flooding",
    "Flooding": "Drainage & Flooding",
    "Drainage System Violation": "Drainage & Flooding",
    "Floodplain": "Drainage & Flooding",
    "Storm Debris Collection": "Drainage & Flooding",
    "Spilled Debris": "Drainage & Flooding",

    # Trash & Recycling
    "Missed Garbage Pickup": "Trash & Recycling",
    "Missed Recycling Pickup": "Trash & Recycling",
    "Missed Yard Waste Pickup": "Trash & Recycling",
    "Recycling Cart Repair": "Trash & Recycling",
    "Recycling Cart Replace": "Trash & Recycling",
    "Recycling Participation NEW": "Trash & Recycling",
    "Recycling Program Start Up": "Trash & Recycling",
    "Recycle Bin/Cart Retrieve": "Trash & Recycling",
    "Recycle Mascot Appearance": "Trash & Recycling",
    "Add A Can": "Trash & Recycling",
    "Add a Can": "Trash & Recycling",
    "Add A Can CANCELLATION": "Trash & Recycling",
    "Add A Can Cancellation": "Trash & Recycling",
    "Add A Cart": "Trash & Recycling",
    "Add A Cart Cancellation": "Trash & Recycling",
    "Add A Cart CANCELLATION": "Trash & Recycling",
    "Add A Bin": "Trash & Recycling",
    "Container Problem": "Trash & Recycling",
    "Container Repair": "Trash & Recycling",
    "Container Replacement": "Trash & Recycling",
    "Container Placement": "Trash & Recycling",
    "Trash Can New": "Trash & Recycling",
    "New Resident Container": "Trash & Recycling",
    "Non Residential Collection Service NEW": "Trash & Recycling",
    "Non Residential Collection CANCEL": "Trash & Recycling",
    "Automated Recycling for Business NEW": "Trash & Recycling",
    'Add a Can Cancellation': "Trash & Recycling",
    'Recycle Program Start Up': "Trash & Recycling",
    'Recycling Cart Repair or Replace': "Trash & Recycling",
    'Order Bag Tags': "Trash & Recycling",

    # Heavy Trash & Code Violations
    "Missed Heavy Trash Pickup": "Heavy Trash & Code Violations",
    "Heavy Trash Violation": "Heavy Trash & Code Violations",
    "Heavy Trash Code Violation": "Heavy Trash & Code Violations",
    "Junk Motor Vehicle - Private Property": "Heavy Trash & Code Violations",
    "Weeds/Trash/Stagnant Water on Property": "Heavy Trash & Code Violations",

    # Road & Street Maintenance
    "Pothole": "Road & Street Maintenance",
    "Street Hazard": "Road & Street Maintenance",
    "Street Condition": "Road & Street Maintenance",
    "Bridge and Barricade": "Road & Street Maintenance",
    "Roadway Icing": "Road & Street Maintenance",
    "Icing Bridge": "Road & Street Maintenance",
    "Icing Roadway": "Road & Street Maintenance",
    "Restoration Due To Utility Work": "Road & Street Maintenance",
    "Parking Lot Pothole": "Road & Street Maintenance",
    "Street Assessment": "Road & Street Maintenance",
    'SPARK Park': "Parks & Recreation",
    'Clean Pavilion or Restroom': "Parks & Recreation",
    'Dugout Repair': "Parks & Recreation",
    'Soccer Goal': "Parks & Recreation",
    'Portacan Problem': "Parks & Recreation",
    'Sprinkler Repair': "Parks & Recreation",

    # Traffic Signals & Signs
    "Traffic Signal Maintenance": "Traffic Signals & Signs",
    "Traffic Signals": "Traffic Signals & Signs",
    "Traffic Signs": "Traffic Signals & Signs",
    "Traffic Markings": "Traffic Signals & Signs",
    "Flashing School Beacon": "Traffic Signals & Signs",
    "Malfunctioning Railroad Signal": "Traffic Signals & Signs",
    "Report Train Noise": "Traffic Signals & Signs",
    "Blocked Train Crossing": "Traffic Signals & Signs",
    'Traffic General': "Traffic Signals & Signs",

    # Street Lighting
    "Lighting": "Street Lighting",
    "Traffic Bridge/Freeway Lighting": "Street Lighting",

    # Parking Enforcement
    "Parking Violation": "Parking Enforcement",
    "Parking Meter": "Parking Enforcement",
    "Parking Escalation": "Parking Enforcement",
    "Parking Enforcement": "Parking Enforcement",

    # Trees & Forestry
    "Tree Trim": "Trees & Forestry",
    "Tree Removal": "Trees & Forestry",
    "Tree Code Violation": "Trees & Forestry",
    "Tree Stump Grinding": "Trees & Forestry",
    "Tree Planting": "Trees & Forestry",
    "Severe Storm Tree Removal": "Trees & Forestry",

    # Parks & Recreation
    "Amenity Repair": "Parks & Recreation",
    "Amenity New": "Parks & Recreation",
    "Playground or Court Equipment": "Parks & Recreation",
    "Playground or Court Equipment Repair": "Parks & Recreation",
    "Park Facilities Escalation": "Parks & Recreation",
    "Park Greenspace Escalation": "Parks & Recreation",
    "Park Forestry Escalation": "Parks & Recreation",
    "Mow Park": "Parks & Recreation",
    "Mow Esplanade or Median": "Parks & Recreation",
    "Litter Park": "Parks & Recreation",
    "Litter Esplanade Median": "Parks & Recreation",

    # Building & Code Enforcement
    "Building Code Violation": "Building & Code Enforcement",
    "Building or Sign Code": "Building & Code Enforcement",
    "Health Code": "Building & Code Enforcement",
    "Sign Code Violation": "Building & Code Enforcement",
    "Minimum Standards": "Building & Code Enforcement",
    "Dangerous Commercial Building": "Building & Code Enforcement",
    "Occupancy Violation": "Building & Code Enforcement",
    'Boarding Homes': "Building & Code Enforcement",
    'Donation Box Violation': "Building & Code Enforcement",
    'Dumpster Complaint': "Building & Code Enforcement",
    'Dumpster Permit': "Building & Code Enforcement",
    'Fire Code Complaint': "Building & Code Enforcement",
    'Electrical Hazard': "Building & Code Enforcement",
    'Pool Fence': "Building & Code Enforcement",
    'Property Damage': "Building & Code Enforcement",
    'Identify Numbered Address': "Building & Code Enforcement",
    'Building Break In' : "Building & Code Enforcement",
    'Ashby Highrise Concern' : "Building & Code Enforcement",
    'Dangerous Buildings' : "Building & Code Enforcement",
    'HPW CCE Escalation' : "Building & Code Enforcement",
    'Minimum Standards - Residence' : "Building & Code Enforcement",

    # Illegal Dumping & Nuisance
    "Trash Dumping or Illegal Dumpsite": "Illegal Dumping & Nuisance",
    "Nuisance On Property": "Illegal Dumping & Nuisance",
    "Nuisance on Commercial Property": "Illegal Dumping & Nuisance",
    "Junk Motor Vehicle": "Illegal Dumping & Nuisance",
    "Bandit Sign": "Illegal Dumping & Nuisance",

    # Environmental & Pollution
    "Air Pollution": "Environmental & Pollution",
    "Water or Ground Pollution": "Environmental & Pollution",
    "Environmental Health Escalation": "Environmental & Pollution",
    "Fuel Island" : "Environmental & Pollution",

    # Storm Damage & Disaster Recovery
    "Storm Damage": "Storm Damage & Disaster Recovery",
    "Disaster Recovery": "Storm Damage & Disaster Recovery",
    "Disaster Recovery Escalation": "Storm Damage & Disaster Recovery",
    "Crisis Cleanup": "Storm Damage & Disaster Recovery",
    "Beryl Power Outage": "Storm Damage & Disaster Recovery",
    "Evacuation Transportation" : "Storm Damage & Disaster Recovery",
    "Medical Evacuation" : "Storm Damage & Disaster Recovery",
    "Reunification Missing" : "Storm Damage & Disaster Recovery",
    "Disaster Preparedness Guide Request" : "Storm Damage & Disaster Recovery",
    "Gessner Explosion" : "Storm Damage & Disaster Recovery",

    # Public Works Projects
    "PWE CIP Project": "Public Works Projects",
    "PW CIP Project": "Public Works Projects",
    "City Engineer": "Public Works Projects",
    "PWE Escalation": "Public Works Projects",
    'New CIP Request': "Public Works Projects",
    'SWM Escalation': "Public Works Projects",
    'HPW Escalation': "Public Works Projects",

    # Neighborhood Services
    "Neighborhood Clean up": "Neighborhood Services",
    "Neighborhood Updates Subscribe": "Neighborhood Services",
    "Neighborhood Updates Unsubscribe": "Neighborhood Services",
    "Neighborhoods Updates - Subscribe": "Neighborhood Services",
    "Neighborhoods Updates - Unsubscribe": "Neighborhood Services",
    "New Move In Service": "Neighborhood Services",
    "New Resident in Private Development": "Neighborhood Services",

    # Animal & Pest Control
    "Dead Animal Collection": "Animal & Pest Control",
    "Pest Control": "Animal & Pest Control",

    # Public Health & Housing
    "MultiFamily Habitability Violation": "Public Health & Housing",
    "Unregulated Boarding House": "Public Health & Housing",
    "Unregulated Residential Facility": "Public Health & Housing",
    "Crisis Housing": "Public Health & Housing",
    "Eviction Notice": "Public Health & Housing",
    "Multi-Resident Facility": "Public Health & Housing",

    # Administrative & Mayor’s Office
    "MYR HR": "Administrative & Mayor’s Office",
    "MYR PW": "Administrative & Mayor’s Office",
    "MYR HPD": "Administrative & Mayor’s Office",
    "MYR HFD": "Administrative & Mayor’s Office",
    "MYR HLT": "Administrative & Mayor’s Office",
    "MYR NS": "Administrative & Mayor’s Office",
    "MYR MCD": "Administrative & Mayor’s Office",
    "MYR LGL": "Administrative & Mayor’s Office",
    "MYR GSD": "Administrative & Mayor’s Office",
    "MYR IT": "Administrative & Mayor’s Office",
    "MYR Communications": "Administrative & Mayor’s Office",
    "MYR AVA": "Administrative & Mayor’s Office",
    "MYR OBO": "Administrative & Mayor’s Office",
    "MYR HCD": "Administrative & Mayor’s Office",
    "MYR PD": "Administrative & Mayor’s Office",
    "MYR LIB": "Administrative & Mayor’s Office",
    "MYR FIN": "Administrative & Mayor’s Office",
    "MYR Correspondence": "Administrative & Mayor’s Office",
    'MYR PR': "Administrative & Mayor’s Office",
    "MAO General": "Administrative & Mayor’s Office",
    "MAO Meeting": "Administrative & Mayor’s Office",
    "MAO Events": "Administrative & Mayor’s Office",
    "MAO Public Session": "Administrative & Mayor’s Office",
    'MYR ARA': "Administrative & Mayor’s Office",
    'MYR HEC': "Administrative & Mayor’s Office",
    'MYR SWM': "Administrative & Mayor’s Office",
    'MYR Public Safety': "Administrative & Mayor’s Office",
    'MOPD Disability Office': "Administrative & Mayor’s Office",
    'MOPD Events': "Administrative & Mayor’s Office",
    'MOPD General': "Administrative & Mayor’s Office",
    'MOPD Meetings': "Administrative & Mayor’s Office",
    'Vital Statistics Escalation': "Administrative & Mayor’s Office",
    'MYR HPD Illegal Dumping' : "Administrative & Mayor’s Office",
    'MYR 311' : "Administrative & Mayor’s Office",
    'MYR CAO' : "Administrative & Mayor’s Office",
    'MYR HPW CCE' : "Administrative & Mayor’s Office",

    # Complaints / Liaison
    "Employee Complaint": "Complaints / Liaison",
    "Liaison Note": "Complaints / Liaison",
    "Liaison Comm": "Complaints / Liaison",
    "Follow-up": "Complaints / Liaison",
    "Miss Complaint": "Complaints / Liaison",
    "Human Trafficking Prevention Violation": "Complaints / Liaison",

    # Transportation & Safety
    "Traffic Applications": "Transportation & Safety",
    "Traffic Programs": "Transportation & Safety",
    "Traffic Safety": "Transportation & Safety",
    "Traffic School Zones": "Transportation & Safety",
    "Traffic School Zone": "Transportation & Safety",
    "Speed Cushion Repair": "Transportation & Safety",
    "Bike Lane Maintenance": "Transportation & Safety",
    'Vehicle for Hire Complaint': "Transportation & Safety",
    'Bandit Sign - Right of Way': "Transportation & Safety",

    # Public Infrastructure / Engineering
    "Post Replace or Install": "Public Infrastructure / Engineering",
    "Fence Repair": "Public Infrastructure / Engineering",
    "Court Surface Repair": "Public Infrastructure / Engineering",
    'Fire Hydrant': "Public Infrastructure / Engineering",
    'Hole in Unpaved Ground': "Public Infrastructure / Engineering",
    'Sidewalk Repair': "Public Infrastructure / Engineering",
    'Paint Stripes': "Public Infrastructure / Engineering",
    'MayorSidewalk': "Public Infrastructure / Engineering",
    'Trail Repair': "Public Infrastructure / Engineering",
    'Pothole Resolution Contact': "Public Infrastructure / Engineering",
    'House Move Route': "Public Infrastructure / Engineering",

    # Other / Unclassified
    "Unclassified 311 Web Request": "Other / Unclassified",
    "Other": "Other / Unclassified",
    "Test": "Other / Unclassified",
    '311 Other': "Other / Unclassified",
    'Case Update': "Other / Unclassified",
    'DPW': "Other / Unclassified",
    'TPIA': "Other / Unclassified",
    'Subpoena': "Other / Unclassified",
    'Administrative Hearing': "Other / Unclassified",
    'Administrative Review': "Other / Unclassified",
    'Language Interpretation': "Other / Unclassified",
    'Complaint Form Request': "Other / Unclassified",
    'GRO Inquiry': "Other / Unclassified",
    'Neighborhoods Escalation': "Other / Unclassified",
}

# Build category → [case types] reverse mapping
category_to_types = defaultdict(list)
for case_type, category in category_mapping.items():
    category_to_types[category].append(case_type)
